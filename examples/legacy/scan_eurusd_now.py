"""
EURUSD Pattern Scanner - Immediate Execution
Scans EURUSD for candlestick patterns and generates HTML report
"""
import sys
from pathlib import Path

# Add skills to path
skill_base = Path(__file__).parent / ".claude" / "skills" / "pattern-scanner" / "scripts"
sys.path.insert(0, str(skill_base))

from candlestick_scanner import scan_symbol_for_patterns
from confluence_calculator import enhance_probability_with_patterns
from html_generator import generate_html_report

# Current EURUSD price
current_price = 1.16575

# Candles data from MetaTrader (already fetched)
candles_data = {
    'M15': """,time,open,high,low,close,tick_volume,spread,real_volume
99,2025-10-29 20:00:00+00:00,1.16573,1.16577,1.16572,1.16575,44,0,0
98,2025-10-29 19:45:00+00:00,1.16599,1.166,1.16553,1.16573,1987,0,0
97,2025-10-29 19:30:00+00:00,1.16622,1.16624,1.1659,1.16597,1577,0,0
96,2025-10-29 19:15:00+00:00,1.1662,1.16636,1.16596,1.16622,1860,0,0
95,2025-10-29 19:00:00+00:00,1.16637,1.16659,1.16578,1.1662,2680,0,0
94,2025-10-29 18:45:00+00:00,1.16565,1.16646,1.16563,1.16636,3110,0,0
93,2025-10-29 18:30:00+00:00,1.1648399999999999,1.16571,1.1648,1.16565,2171,0,0
92,2025-10-29 18:15:00+00:00,1.16454,1.16507,1.16451,1.16485,1949,0,0
91,2025-10-29 18:00:00+00:00,1.16504,1.16532,1.1645,1.16454,2436,0,0
90,2025-10-29 17:45:00+00:00,1.16433,1.16514,1.16421,1.16504,1655,0,0
89,2025-10-29 17:30:00+00:00,1.16436,1.16452,1.16415,1.16433,2035,0,0
88,2025-10-29 17:15:00+00:00,1.16383,1.1645,1.1637,1.16436,2398,0,0
87,2025-10-29 17:00:00+00:00,1.16368,1.16401,1.16316,1.16383,2952,0,0
86,2025-10-29 16:45:00+00:00,1.1638600000000001,1.16416,1.16346,1.16368,3035,0,0
85,2025-10-29 16:30:00+00:00,1.16431,1.1644700000000001,1.16363,1.1638600000000001,2485,0,0
84,2025-10-29 16:15:00+00:00,1.16379,1.16458,1.16374,1.1643,3107,0,0
83,2025-10-29 16:00:00+00:00,1.16342,1.16382,1.16336,1.16379,2399,0,0
82,2025-10-29 15:45:00+00:00,1.16319,1.16345,1.16276,1.16341,2605,0,0
81,2025-10-29 15:30:00+00:00,1.16376,1.16385,1.16305,1.1632,2401,0,0
80,2025-10-29 15:15:00+00:00,1.16401,1.1641,1.16334,1.16376,2287,0,0
79,2025-10-29 15:00:00+00:00,1.1639599999999999,1.1645,1.1638600000000001,1.16402,2373,0,0
78,2025-10-29 14:45:00+00:00,1.16402,1.16426,1.16384,1.16397,1750,0,0
77,2025-10-29 14:30:00+00:00,1.16341,1.16409,1.1633,1.16402,1742,0,0
76,2025-10-29 14:15:00+00:00,1.16427,1.16427,1.16336,1.16342,1951,0,0
75,2025-10-29 14:00:00+00:00,1.16472,1.16486,1.1642000000000001,1.16426,1456,0,0
74,2025-10-29 13:45:00+00:00,1.16455,1.1648399999999999,1.16439,1.16472,1446,0,0
73,2025-10-29 13:30:00+00:00,1.16452,1.16488,1.16448,1.16455,1781,0,0
72,2025-10-29 13:15:00+00:00,1.16415,1.16458,1.16408,1.16453,1309,0,0
71,2025-10-29 13:00:00+00:00,1.16412,1.16434,1.1637,1.16415,1782,0,0
70,2025-10-29 12:45:00+00:00,1.16375,1.1647,1.16372,1.16411,2529,0,0
69,2025-10-29 12:30:00+00:00,1.16282,1.16399,1.16276,1.16375,1795,0,0
68,2025-10-29 12:15:00+00:00,1.16233,1.16305,1.16212,1.16284,2083,0,0
67,2025-10-29 12:00:00+00:00,1.16231,1.16243,1.16187,1.16233,1903,0,0
66,2025-10-29 11:45:00+00:00,1.16302,1.16305,1.16228,1.16231,2009,0,0
65,2025-10-29 11:30:00+00:00,1.16329,1.16342,1.16266,1.16303,2079,0,0
64,2025-10-29 11:15:00+00:00,1.1626,1.16342,1.16251,1.16328,2057,0,0
63,2025-10-29 11:00:00+00:00,1.16324,1.16333,1.16251,1.1626,2038,0,0
62,2025-10-29 10:45:00+00:00,1.1635900000000001,1.1636199999999999,1.16317,1.1632500000000001,2195,0,0
61,2025-10-29 10:30:00+00:00,1.1636,1.16364,1.16291,1.1635900000000001,2088,0,0
60,2025-10-29 10:15:00+00:00,1.16349,1.1638,1.1633499999999999,1.1635900000000001,1899,0,0
59,2025-10-29 10:00:00+00:00,1.1629800000000001,1.16356,1.16283,1.16349,1933,0,0
58,2025-10-29 09:45:00+00:00,1.16295,1.16303,1.16279,1.16297,1210,0,0
57,2025-10-29 09:30:00+00:00,1.16299,1.16327,1.16291,1.16295,1208,0,0
56,2025-10-29 09:15:00+00:00,1.16304,1.16323,1.16285,1.16299,1283,0,0
55,2025-10-29 09:00:00+00:00,1.16316,1.16317,1.1625,1.16305,1592,0,0
54,2025-10-29 08:45:00+00:00,1.1630099999999999,1.16321,1.16279,1.16315,1551,0,0
53,2025-10-29 08:30:00+00:00,1.16291,1.16312,1.16272,1.16303,1412,0,0
52,2025-10-29 08:15:00+00:00,1.16304,1.16317,1.1628,1.16291,1295,0,0
51,2025-10-29 08:00:00+00:00,1.16343,1.16357,1.16299,1.16304,1032,0,0
50,2025-10-29 07:45:00+00:00,1.1633,1.16344,1.16315,1.16341,909,0,0
49,2025-10-29 07:30:00+00:00,1.16354,1.16356,1.16323,1.1633,842,0,0
48,2025-10-29 07:15:00+00:00,1.16357,1.16375,1.16353,1.16354,892,0,0
47,2025-10-29 07:00:00+00:00,1.16374,1.16377,1.16355,1.1635900000000001,882,0,0
46,2025-10-29 06:45:00+00:00,1.16387,1.16392,1.16368,1.16372,610,0,0
45,2025-10-29 06:30:00+00:00,1.16427,1.16428,1.16381,1.16387,882,0,0
44,2025-10-29 06:15:00+00:00,1.16439,1.16445,1.16425,1.16427,689,0,0
43,2025-10-29 06:00:00+00:00,1.16464,1.16468,1.16437,1.16439,875,0,0
42,2025-10-29 05:45:00+00:00,1.16433,1.16466,1.16433,1.16462,852,0,0
41,2025-10-29 05:30:00+00:00,1.16432,1.16443,1.16417,1.16433,796,0,0
40,2025-10-29 05:15:00+00:00,1.16464,1.16465,1.1643,1.16432,769,0,0
39,2025-10-29 05:00:00+00:00,1.16475,1.1648100000000001,1.16451,1.16464,885,0,0
38,2025-10-29 04:45:00+00:00,1.16472,1.16496,1.16471,1.16474,1253,0,0
37,2025-10-29 04:30:00+00:00,1.16502,1.16511,1.16462,1.16472,1733,0,0
36,2025-10-29 04:15:00+00:00,1.16531,1.16553,1.1649,1.16502,1377,0,0
35,2025-10-29 04:00:00+00:00,1.16545,1.16561,1.1652,1.16533,1248,0,0
34,2025-10-29 03:45:00+00:00,1.16559,1.166,1.16533,1.16545,2269,0,0
33,2025-10-29 03:30:00+00:00,1.16571,1.166,1.16531,1.16559,1893,0,0
32,2025-10-29 03:15:00+00:00,1.16571,1.16591,1.16541,1.16572,1859,0,0
31,2025-10-29 03:00:00+00:00,1.16572,1.16609,1.16561,1.1656900000000001,1839,0,0
30,2025-10-29 02:45:00+00:00,1.1651,1.16574,1.16486,1.16572,874,0,0
29,2025-10-29 02:30:00+00:00,1.16502,1.16511,1.16498,1.1651,291,0,0
28,2025-10-29 02:15:00+00:00,1.1650800000000001,1.16528,1.16501,1.16502,425,0,0
27,2025-10-29 02:00:00+00:00,1.16505,1.16513,1.16499,1.1650800000000001,298,0,0
26,2025-10-29 01:45:00+00:00,1.16512,1.16514,1.16498,1.16505,376,0,0
25,2025-10-29 01:30:00+00:00,1.16538,1.16539,1.1651,1.16512,293,0,0
24,2025-10-29 01:15:00+00:00,1.16533,1.16544,1.16524,1.16539,423,0,0
23,2025-10-29 01:00:00+00:00,1.16511,1.16538,1.16509,1.16533,1113,0,0
22,2025-10-29 00:45:00+00:00,1.16521,1.16521,1.1650800000000001,1.16512,178,12,0
21,2025-10-29 00:30:00+00:00,1.16517,1.16525,1.16507,1.1651799999999999,449,12,0
20,2025-10-29 00:15:00+00:00,1.1650800000000001,1.1652,1.16503,1.16517,245,12,0
19,2025-10-29 00:00:00+00:00,1.16501,1.16529,1.16501,1.16504,210,12,0
18,2025-10-28 23:45:00+00:00,1.16543,1.16551,1.1652,1.16523,766,0,0
17,2025-10-28 23:30:00+00:00,1.1654200000000001,1.16553,1.1651,1.16543,584,0,0
16,2025-10-28 23:15:00+00:00,1.16561,1.16573,1.16538,1.16543,653,0,0
15,2025-10-28 23:00:00+00:00,1.16524,1.16572,1.16523,1.16561,741,0,0
14,2025-10-28 22:45:00+00:00,1.16607,1.16611,1.16519,1.16524,1491,0,0
13,2025-10-28 22:30:00+00:00,1.16635,1.16636,1.16606,1.16607,853,0,0
12,2025-10-28 22:15:00+00:00,1.16641,1.16648,1.16628,1.16634,801,0,0
11,2025-10-28 22:00:00+00:00,1.16621,1.16653,1.16617,1.16641,1145,0,0
10,2025-10-28 21:45:00+00:00,1.16604,1.1663000000000001,1.16598,1.1662,1070,0,0
9,2025-10-28 21:30:00+00:00,1.16578,1.16618,1.16561,1.1660300000000001,1361,0,0
8,2025-10-28 21:15:00+00:00,1.1661,1.16619,1.16574,1.16577,950,0,0
7,2025-10-28 21:00:00+00:00,1.16633,1.16638,1.16584,1.1661,1046,0,0
6,2025-10-28 20:45:00+00:00,1.16638,1.16646,1.1661,1.16632,1339,0,0
5,2025-10-28 20:30:00+00:00,1.16642,1.16669,1.16619,1.16639,1516,0,0
4,2025-10-28 20:15:00+00:00,1.1662,1.16668,1.16614,1.16641,1942,0,0
3,2025-10-28 20:00:00+00:00,1.16681,1.16689,1.16593,1.1662,2413,0,0
2,2025-10-28 19:45:00+00:00,1.1655,1.1668,1.1653,1.1668,2415,0,0
1,2025-10-28 19:30:00+00:00,1.1662,1.16635,1.16543,1.16549,2707,0,0
0,2025-10-28 19:15:00+00:00,1.1659,1.16623,1.1657899999999999,1.1662,1626,0,0""",
    'H1': """,time,open,high,low,close,tick_volume,spread,real_volume
99,2025-10-29 20:00:00+00:00,1.16573,1.16577,1.16572,1.16575,44,0,0
98,2025-10-29 19:00:00+00:00,1.16637,1.16659,1.16553,1.16573,8104,0,0
97,2025-10-29 18:00:00+00:00,1.16504,1.16646,1.1645,1.16636,9666,0,0
96,2025-10-29 17:00:00+00:00,1.16368,1.16514,1.16316,1.16504,9040,0,0
95,2025-10-29 16:00:00+00:00,1.16342,1.16458,1.16336,1.16368,11026,0,0
94,2025-10-29 15:00:00+00:00,1.1639599999999999,1.1645,1.16276,1.16341,9666,0,0
93,2025-10-29 14:00:00+00:00,1.16472,1.16486,1.1633,1.16397,6899,0,0
92,2025-10-29 13:00:00+00:00,1.16412,1.16488,1.1637,1.16472,6318,0,0
91,2025-10-29 12:00:00+00:00,1.16231,1.1647,1.16187,1.16411,8310,0,0
90,2025-10-29 11:00:00+00:00,1.16324,1.16342,1.16228,1.16231,8183,0,0
89,2025-10-29 10:00:00+00:00,1.1629800000000001,1.1638,1.16283,1.1632500000000001,8115,0,0
88,2025-10-29 09:00:00+00:00,1.16316,1.16327,1.1625,1.16297,5293,0,0
87,2025-10-29 08:00:00+00:00,1.16343,1.16357,1.16272,1.16315,5290,0,0
86,2025-10-29 07:00:00+00:00,1.16374,1.16377,1.16315,1.16341,3525,0,0
85,2025-10-29 06:00:00+00:00,1.16464,1.16468,1.16368,1.16372,3056,0,0
84,2025-10-29 05:00:00+00:00,1.16475,1.1648100000000001,1.16417,1.16462,3302,0,0
83,2025-10-29 04:00:00+00:00,1.16545,1.16561,1.16462,1.16474,5611,0,0
82,2025-10-29 03:00:00+00:00,1.16572,1.16609,1.16531,1.16545,7860,0,0
81,2025-10-29 02:00:00+00:00,1.16505,1.16574,1.16486,1.16572,1888,0,0
80,2025-10-29 01:00:00+00:00,1.16511,1.16544,1.16498,1.16505,2205,0,0
79,2025-10-29 00:00:00+00:00,1.16501,1.16529,1.16501,1.16512,1082,12,0
78,2025-10-28 23:00:00+00:00,1.16524,1.16573,1.1651,1.16523,2744,0,0
77,2025-10-28 22:00:00+00:00,1.16621,1.16653,1.16519,1.16524,4290,0,0
76,2025-10-28 21:00:00+00:00,1.16633,1.16638,1.16561,1.1662,4427,0,0
75,2025-10-28 20:00:00+00:00,1.16681,1.16689,1.16593,1.16632,7210,0,0
74,2025-10-28 19:00:00+00:00,1.16589,1.1668,1.1653,1.1668,8926,0,0
73,2025-10-28 18:00:00+00:00,1.16605,1.1667399999999999,1.1655,1.16589,9395,0,0
72,2025-10-28 17:00:00+00:00,1.1639599999999999,1.16634,1.1637,1.16605,11170,0,0
71,2025-10-28 16:00:00+00:00,1.16402,1.16406,1.16253,1.16395,10154,0,0
70,2025-10-28 15:00:00+00:00,1.16593,1.16601,1.16351,1.16402,10147,0,0
69,2025-10-28 14:00:00+00:00,1.16642,1.16645,1.16549,1.16594,6560,0,0
68,2025-10-28 13:00:00+00:00,1.16568,1.16651,1.16547,1.16642,6461,0,0
67,2025-10-28 12:00:00+00:00,1.16522,1.16588,1.1645,1.16568,7601,0,0
66,2025-10-28 11:00:00+00:00,1.1655,1.16629,1.1648399999999999,1.16525,9742,0,0
65,2025-10-28 10:00:00+00:00,1.16556,1.16616,1.1651,1.1655,7480,0,0
64,2025-10-28 09:00:00+00:00,1.16637,1.16673,1.16547,1.16557,4856,0,0
63,2025-10-28 08:00:00+00:00,1.16659,1.1668,1.16626,1.16637,4565,0,0
62,2025-10-28 07:00:00+00:00,1.16599,1.16678,1.16588,1.16659,4015,0,0
61,2025-10-28 06:00:00+00:00,1.16544,1.1663000000000001,1.16541,1.16599,3480,0,0
60,2025-10-28 05:00:00+00:00,1.16576,1.16634,1.16539,1.16544,3208,0,0
59,2025-10-28 04:00:00+00:00,1.16556,1.1663999999999999,1.16549,1.16576,4841,0,0
58,2025-10-28 03:00:00+00:00,1.1650800000000001,1.16588,1.16463,1.16556,4945,0,0
57,2025-10-28 02:00:00+00:00,1.16499,1.16547,1.16495,1.1651,2375,0,0
56,2025-10-28 01:00:00+00:00,1.16445,1.1650800000000001,1.16445,1.16499,1980,0,0
55,2025-10-28 00:00:00+00:00,1.16443,1.16452,1.16439,1.1644700000000001,1005,12,0
54,2025-10-27 23:00:00+00:00,1.16477,1.1649,1.16436,1.16441,2232,0,0
53,2025-10-27 22:00:00+00:00,1.16503,1.16505,1.1644,1.16477,4242,0,0
52,2025-10-27 21:00:00+00:00,1.16382,1.16521,1.1635,1.16503,4853,0,0
51,2025-10-27 20:00:00+00:00,1.16388,1.16418,1.16356,1.16381,4498,0,0
50,2025-10-27 19:00:00+00:00,1.16353,1.1641,1.1632500000000001,1.16389,6941,0,0
49,2025-10-27 18:00:00+00:00,1.16408,1.16419,1.16326,1.16354,8512,0,0
48,2025-10-27 17:00:00+00:00,1.16358,1.16426,1.1632500000000001,1.16409,8175,0,0
47,2025-10-27 16:00:00+00:00,1.16415,1.16429,1.16317,1.16358,8986,0,0
46,2025-10-27 15:00:00+00:00,1.1646,1.16515,1.16377,1.16415,8005,0,0
45,2025-10-27 14:00:00+00:00,1.16413,1.16474,1.1635900000000001,1.1646,7260,0,0
44,2025-10-27 13:00:00+00:00,1.16379,1.16446,1.16354,1.16414,6750,0,0
43,2025-10-27 12:00:00+00:00,1.16285,1.164,1.16261,1.16378,8078,0,0
42,2025-10-27 11:00:00+00:00,1.16198,1.16333,1.16174,1.16284,8463,0,0
41,2025-10-27 10:00:00+00:00,1.16268,1.1628,1.16196,1.16199,7086,0,0
40,2025-10-27 09:00:00+00:00,1.16263,1.16323,1.16247,1.16265,5895,0,0
39,2025-10-27 08:00:00+00:00,1.16246,1.16272,1.16207,1.16263,3347,0,0
38,2025-10-27 07:00:00+00:00,1.16276,1.16279,1.16208,1.16245,3514,0,0
37,2025-10-27 06:00:00+00:00,1.16307,1.1632500000000001,1.16268,1.16276,2578,0,0
36,2025-10-27 05:00:00+00:00,1.16388,1.16397,1.16302,1.16308,3430,0,0
35,2025-10-27 04:00:00+00:00,1.16347,1.16478,1.16332,1.1639,5743,0,0
34,2025-10-27 03:00:00+00:00,1.16313,1.16377,1.1628,1.16349,4862,0,0
33,2025-10-27 02:00:00+00:00,1.16284,1.16328,1.16257,1.16313,2666,0,0
32,2025-10-27 01:00:00+00:00,1.16282,1.16353,1.16257,1.16284,4103,0,0
31,2025-10-27 00:00:00+00:00,1.1632,1.16356,1.16221,1.16282,1827,38,0
30,2025-10-24 23:00:00+00:00,1.16315,1.1636,1.16209,1.16272,3328,0,0
29,2025-10-24 22:00:00+00:00,1.16262,1.1633499999999999,1.16261,1.16314,4264,0,0
28,2025-10-24 21:00:00+00:00,1.16275,1.16281,1.16248,1.16262,4204,0,0
27,2025-10-24 20:00:00+00:00,1.16257,1.1632,1.16243,1.1627399999999999,4493,0,0
26,2025-10-24 19:00:00+00:00,1.16253,1.16277,1.16212,1.16257,5316,0,0
25,2025-10-24 18:00:00+00:00,1.16261,1.16355,1.16214,1.16253,9624,0,0
24,2025-10-24 17:00:00+00:00,1.16266,1.1636,1.16178,1.16262,12578,0,0
23,2025-10-24 16:00:00+00:00,1.16341,1.16434,1.16207,1.16269,13630,0,0
22,2025-10-24 15:00:00+00:00,1.1615199999999999,1.16485,1.16087,1.16341,15439,0,0
21,2025-10-24 14:00:00+00:00,1.16128,1.16158,1.16071,1.16151,7039,0,0
20,2025-10-24 13:00:00+00:00,1.16121,1.16166,1.16109,1.16127,5466,0,0
19,2025-10-24 12:00:00+00:00,1.161,1.16131,1.16053,1.1612,6453,0,0
18,2025-10-24 11:00:00+00:00,1.1618,1.16236,1.16062,1.16104,9509,0,0
17,2025-10-24 10:00:00+00:00,1.16136,1.16281,1.16018,1.16181,9730,0,0
16,2025-10-24 09:00:00+00:00,1.16056,1.1614,1.1601,1.16135,6517,0,0
15,2025-10-24 08:00:00+00:00,1.16076,1.1608100000000001,1.16019,1.16056,3261,0,0
14,2025-10-24 07:00:00+00:00,1.1609,1.16093,1.1605699999999999,1.16077,2119,0,0
13,2025-10-24 06:00:00+00:00,1.1608,1.16119,1.16071,1.1609,2268,0,0
12,2025-10-24 05:00:00+00:00,1.16093,1.16127,1.16076,1.1608,3364,0,0
11,2025-10-24 04:00:00+00:00,1.1617899999999999,1.1619,1.16087,1.16095,3645,0,0
10,2025-10-24 03:00:00+00:00,1.16173,1.16218,1.16168,1.1617899999999999,3111,0,0
9,2025-10-24 02:00:00+00:00,1.1617899999999999,1.16191,1.16148,1.16173,1780,0,0
8,2025-10-24 01:00:00+00:00,1.16165,1.16214,1.16165,1.1617899999999999,1462,0,0
7,2025-10-24 00:00:00+00:00,1.16163,1.1617899999999999,1.16139,1.16165,1489,12,0
6,2025-10-23 23:00:00+00:00,1.16166,1.16194,1.16136,1.1617899999999999,2151,0,0
5,2025-10-23 22:00:00+00:00,1.16176,1.1620300000000001,1.1615199999999999,1.16166,3300,0,0
4,2025-10-23 21:00:00+00:00,1.16119,1.1618,1.16096,1.16176,3683,0,0
3,2025-10-23 20:00:00+00:00,1.16069,1.16122,1.16043,1.1611799999999999,5269,0,0
2,2025-10-23 19:00:00+00:00,1.1611799999999999,1.16163,1.16065,1.16068,6346,0,0
1,2025-10-23 18:00:00+00:00,1.16131,1.16159,1.16063,1.1611799999999999,7494,0,0
0,2025-10-23 17:00:00+00:00,1.1607,1.16198,1.16055,1.16131,11230,0,0""",
    'H4': """,time,open,high,low,close,tick_volume,spread,real_volume
99,2025-10-29 20:00:00+00:00,1.16573,1.16577,1.16572,1.16575,44,0,0
98,2025-10-29 16:00:00+00:00,1.16342,1.16659,1.16316,1.16573,37836,0,0
97,2025-10-29 12:00:00+00:00,1.16231,1.16488,1.16187,1.16341,31193,0,0
96,2025-10-29 08:00:00+00:00,1.16343,1.1638,1.16228,1.16231,26881,0,0
95,2025-10-29 04:00:00+00:00,1.16545,1.16561,1.16315,1.16341,15494,0,0
94,2025-10-29 00:00:00+00:00,1.16501,1.16609,1.16486,1.16545,13035,0,0
93,2025-10-28 20:00:00+00:00,1.16681,1.16689,1.1651,1.16523,18671,0,0
92,2025-10-28 16:00:00+00:00,1.16402,1.1668,1.16253,1.1668,39645,0,0
91,2025-10-28 12:00:00+00:00,1.16522,1.16651,1.16351,1.16402,30769,0,0
90,2025-10-28 08:00:00+00:00,1.16659,1.1668,1.1648399999999999,1.16525,26643,0,0
89,2025-10-28 04:00:00+00:00,1.16556,1.16678,1.16539,1.16659,15544,0,0
88,2025-10-28 00:00:00+00:00,1.16443,1.16588,1.16439,1.16556,10305,0,0
87,2025-10-27 20:00:00+00:00,1.16388,1.16521,1.1635,1.16441,15825,0,0
86,2025-10-27 16:00:00+00:00,1.16415,1.16429,1.16317,1.16389,32614,0,0
85,2025-10-27 12:00:00+00:00,1.16285,1.16515,1.16261,1.16415,30093,0,0
84,2025-10-27 08:00:00+00:00,1.16246,1.16333,1.16174,1.16284,24791,0,0
83,2025-10-27 04:00:00+00:00,1.16347,1.16478,1.16208,1.16245,15265,0,0
82,2025-10-27 00:00:00+00:00,1.1632,1.16377,1.16221,1.16349,13458,0,0
81,2025-10-24 20:00:00+00:00,1.16257,1.1636,1.16209,1.16272,16289,0,0
80,2025-10-24 16:00:00+00:00,1.16341,1.16434,1.16178,1.16257,41148,0,0
79,2025-10-24 12:00:00+00:00,1.161,1.16485,1.16053,1.16341,34397,0,0
78,2025-10-24 08:00:00+00:00,1.16076,1.16281,1.1601,1.16104,29017,0,0
77,2025-10-24 04:00:00+00:00,1.1617899999999999,1.1619,1.1605699999999999,1.16077,11396,0,0
76,2025-10-24 00:00:00+00:00,1.16163,1.16218,1.16139,1.1617899999999999,7842,0,0
75,2025-10-23 20:00:00+00:00,1.16069,1.1620300000000001,1.16043,1.1617899999999999,14403,0,0
74,2025-10-23 16:00:00+00:00,1.16007,1.16198,1.15983,1.16068,35699,0,0
73,2025-10-23 12:00:00+00:00,1.1596,1.16061,1.15852,1.16008,26397,0,0
72,2025-10-23 08:00:00+00:00,1.15988,1.16062,1.15903,1.1595900000000001,25104,0,0
71,2025-10-23 04:00:00+00:00,1.16042,1.16056,1.15904,1.15988,12131,0,0
70,2025-10-23 00:00:00+00:00,1.16058,1.16145,1.15978,1.16041,9435,0,0
69,2025-10-22 20:00:00+00:00,1.16196,1.16205,1.16049,1.16094,18290,0,0
68,2025-10-22 16:00:00+00:00,1.15832,1.16224,1.15817,1.16196,41328,0,0
67,2025-10-22 12:00:00+00:00,1.15975,1.16022,1.1577,1.15832,33308,0,0
66,2025-10-22 08:00:00+00:00,1.16093,1.16158,1.159,1.15976,32019,0,0
65,2025-10-22 04:00:00+00:00,1.1604700000000001,1.1611,1.16015,1.16093,11547,0,0
64,2025-10-22 00:00:00+00:00,1.15977,1.1608100000000001,1.15973,1.16048,9459,0,0
63,2025-10-21 20:00:00+00:00,1.1609099999999999,1.161,1.15989,1.15995,19677,0,0
62,2025-10-21 16:00:00+00:00,1.1611,1.16244,1.15978,1.1609099999999999,50412,0,0
61,2025-10-21 12:00:00+00:00,1.16211,1.16272,1.16021,1.16111,41094,0,0
60,2025-10-21 08:00:00+00:00,1.1636199999999999,1.16376,1.1613,1.16212,34019,0,0
59,2025-10-21 04:00:00+00:00,1.16532,1.16532,1.16319,1.16361,18314,0,0
58,2025-10-21 00:00:00+00:00,1.16404,1.16553,1.16383,1.16533,9795,0,0
57,2025-10-20 20:00:00+00:00,1.16494,1.16531,1.16383,1.16412,16511,0,0
56,2025-10-20 16:00:00+00:00,1.16536,1.16646,1.16464,1.16496,35341,0,0
55,2025-10-20 12:00:00+00:00,1.16636,1.16678,1.16445,1.16535,35641,0,0
54,2025-10-20 08:00:00+00:00,1.16714,1.16757,1.16538,1.16636,29958,0,0
53,2025-10-20 04:00:00+00:00,1.16665,1.16739,1.16565,1.16716,15726,0,0
52,2025-10-20 00:00:00+00:00,1.1661299999999999,1.16667,1.16519,1.1666400000000001,13479,0,0
51,2025-10-17 20:00:00+00:00,1.16708,1.16759,1.16504,1.16531,23302,0,0
50,2025-10-17 16:00:00+00:00,1.16766,1.1681300000000001,1.16561,1.16709,50013,0,0
49,2025-10-17 12:00:00+00:00,1.16974,1.17077,1.16671,1.16765,38685,0,0
48,2025-10-17 08:00:00+00:00,1.17099,1.17283,1.1691799999999999,1.16974,43767,0,0
47,2025-10-17 04:00:00+00:00,1.17066,1.1712500000000001,1.16954,1.17099,21372,0,0
46,2025-10-17 00:00:00+00:00,1.16826,1.17113,1.16814,1.1706699999999999,13461,0,0
45,2025-10-16 20:00:00+00:00,1.16771,1.16943,1.16767,1.16873,30155,0,0
44,2025-10-16 16:00:00+00:00,1.16606,1.16791,1.16502,1.16772,49659,0,0
43,2025-10-16 12:00:00+00:00,1.16588,1.16638,1.16463,1.16605,34603,0,0
42,2025-10-16 08:00:00+00:00,1.16564,1.16681,1.16432,1.16589,35152,0,0
41,2025-10-16 04:00:00+00:00,1.16634,1.16753,1.16554,1.16562,21402,0,0
40,2025-10-16 00:00:00+00:00,1.16433,1.16672,1.1641,1.16633,14992,0,0
39,2025-10-15 20:00:00+00:00,1.16399,1.16476,1.1627,1.16471,24801,0,0
38,2025-10-15 16:00:00+00:00,1.16177,1.16472,1.16104,1.164,49012,0,0
37,2025-10-15 12:00:00+00:00,1.1632500000000001,1.16391,1.16139,1.16176,34131,0,0
36,2025-10-15 08:00:00+00:00,1.16184,1.16456,1.16176,1.16326,34443,0,0
35,2025-10-15 04:00:00+00:00,1.16105,1.1626,1.1607,1.16183,20726,0,0
34,2025-10-15 00:00:00+00:00,1.16058,1.1614200000000001,1.16016,1.16105,11055,0,0
33,2025-10-14 20:00:00+00:00,1.16094,1.16121,1.16,1.16077,25162,0,0
32,2025-10-14 16:00:00+00:00,1.15556,1.1615,1.15541,1.16095,57846,0,0
31,2025-10-14 12:00:00+00:00,1.1559,1.15651,1.15463,1.15556,38160,0,0
30,2025-10-14 08:00:00+00:00,1.1592,1.15936,1.1542,1.15591,46411,0,0
29,2025-10-14 04:00:00+00:00,1.15612,1.15927,1.15608,1.15919,21313,0,0
28,2025-10-14 00:00:00+00:00,1.15635,1.15741,1.15546,1.15611,12444,0,0
27,2025-10-13 20:00:00+00:00,1.15754,1.15777,1.15651,1.15705,17160,0,0
26,2025-10-13 16:00:00+00:00,1.15688,1.15792,1.15575,1.15753,39532,0,0
25,2025-10-13 12:00:00+00:00,1.15856,1.15982,1.15618,1.15687,35780,0,0
24,2025-10-13 08:00:00+00:00,1.16206,1.16299,1.15816,1.15856,38223,0,0
23,2025-10-13 04:00:00+00:00,1.16158,1.16276,1.16096,1.16205,19146,0,0
22,2025-10-13 00:00:00+00:00,1.16109,1.16159,1.15919,1.16157,22441,0,0
21,2025-10-10 20:00:00+00:00,1.1605699999999999,1.1625,1.15972,1.16245,27024,0,0
20,2025-10-10 16:00:00+00:00,1.1572,1.16306,1.15616,1.16058,61806,0,0
19,2025-10-10 12:00:00+00:00,1.15788,1.15836,1.15594,1.1572,33479,0,0
18,2025-10-10 08:00:00+00:00,1.15737,1.15895,1.15611,1.15788,35580,0,0
17,2025-10-10 04:00:00+00:00,1.15675,1.15743,1.15626,1.15737,15185,0,0
16,2025-10-10 00:00:00+00:00,1.15642,1.15706,1.1553,1.15676,12712,0,0
15,2025-10-09 20:00:00+00:00,1.1558,1.1567,1.15422,1.15642,26659,0,0
14,2025-10-09 16:00:00+00:00,1.16151,1.16226,1.15473,1.15579,63053,0,0
13,2025-10-09 12:00:00+00:00,1.16127,1.1627399999999999,1.16051,1.1615199999999999,39129,0,0
12,2025-10-09 08:00:00+00:00,1.16456,1.1648399999999999,1.16032,1.16126,37241,0,0
11,2025-10-09 04:00:00+00:00,1.16372,1.16479,1.16367,1.16456,18896,0,0
10,2025-10-09 00:00:00+00:00,1.16284,1.16411,1.16186,1.16373,16786,0,0
9,2025-10-08 20:00:00+00:00,1.16054,1.16324,1.15992,1.16284,26133,0,0
8,2025-10-08 16:00:00+00:00,1.16324,1.1644700000000001,1.15984,1.16055,44019,0,0
7,2025-10-08 12:00:00+00:00,1.16148,1.16381,1.16061,1.1632500000000001,35527,0,0
6,2025-10-08 08:00:00+00:00,1.16191,1.16354,1.16068,1.16147,38157,0,0
5,2025-10-08 04:00:00+00:00,1.16474,1.16474,1.16159,1.16194,26433,0,0
4,2025-10-08 00:00:00+00:00,1.16543,1.16614,1.16452,1.16474,12124,0,0
3,2025-10-07 20:00:00+00:00,1.16702,1.16794,1.16475,1.16573,23699,0,0
2,2025-10-07 16:00:00+00:00,1.1667,1.16812,1.16544,1.16703,45660,0,0
1,2025-10-07 12:00:00+00:00,1.16658,1.16761,1.16537,1.1667,33002,0,0
0,2025-10-07 08:00:00+00:00,1.16984,1.17,1.16649,1.16659,29248,0,0""",
    'D1': """,time,open,high,low,close,tick_volume,spread,real_volume
99,2025-10-29 00:00:00+00:00,1.16501,1.16659,1.16187,1.16573,124484,0,0
98,2025-10-28 00:00:00+00:00,1.16443,1.16689,1.16253,1.16523,141577,0,0
97,2025-10-27 00:00:00+00:00,1.1632,1.16521,1.16174,1.16441,132046,0,0
96,2025-10-24 00:00:00+00:00,1.16163,1.16485,1.1601,1.16272,140089,0,0
95,2025-10-23 00:00:00+00:00,1.16058,1.1620300000000001,1.15852,1.1617899999999999,123169,0,0
94,2025-10-22 00:00:00+00:00,1.15977,1.16224,1.1577,1.16094,145951,0,0
93,2025-10-21 00:00:00+00:00,1.16404,1.16553,1.15978,1.15995,173311,0,0
92,2025-10-20 00:00:00+00:00,1.1661299999999999,1.16757,1.16383,1.16412,146656,0,0
91,2025-10-17 00:00:00+00:00,1.16826,1.17283,1.16504,1.16531,190600,0,0
90,2025-10-16 00:00:00+00:00,1.16433,1.16943,1.1641,1.16873,185963,0,0
89,2025-10-15 00:00:00+00:00,1.16058,1.16476,1.16016,1.16471,174168,0,0
88,2025-10-14 00:00:00+00:00,1.15635,1.1615,1.1542,1.16077,201336,0,0
87,2025-10-13 00:00:00+00:00,1.16109,1.16299,1.15575,1.15705,172282,0,0
86,2025-10-10 00:00:00+00:00,1.15642,1.16306,1.1553,1.16245,185786,0,0
85,2025-10-09 00:00:00+00:00,1.16284,1.1648399999999999,1.15422,1.15642,201764,0,0
84,2025-10-08 00:00:00+00:00,1.16543,1.16614,1.15984,1.16284,182393,0,0
83,2025-10-07 00:00:00+00:00,1.17049,1.17147,1.16475,1.16573,157088,0,0
82,2025-10-06 00:00:00+00:00,1.17194,1.1731,1.16517,1.17123,180485,0,0
81,2025-10-03 00:00:00+00:00,1.1712,1.17594,1.1712,1.17399,132584,0,0
80,2025-10-02 00:00:00+00:00,1.17236,1.17585,1.16831,1.17163,143844,0,0
79,2025-10-01 00:00:00+00:00,1.17301,1.17787,1.17155,1.17307,172162,0,0
78,2025-09-30 00:00:00+00:00,1.17224,1.17617,1.17122,1.1733500000000001,148358,0,0
77,2025-09-29 00:00:00+00:00,1.16987,1.17548,1.16961,1.17271,142370,0,0
76,2025-09-26 00:00:00+00:00,1.16577,1.17071,1.16517,1.1702,152284,0,0
75,2025-09-25 00:00:00+00:00,1.17375,1.17542,1.16454,1.16655,163468,0,0
74,2025-09-24 00:00:00+00:00,1.18127,1.18189,1.1728,1.17381,152564,0,0
73,2025-09-23 00:00:00+00:00,1.1792,1.18199,1.17783,1.18148,156163,0,0
72,2025-09-22 00:00:00+00:00,1.17386,1.18029,1.17261,1.1802,140567,0,0
71,2025-09-19 00:00:00+00:00,1.17807,1.17925,1.17289,1.17432,166576,0,0
70,2025-09-18 00:00:00+00:00,1.18113,1.18484,1.175,1.1786,174980,0,0
69,2025-09-17 00:00:00+00:00,1.18595,1.19181,1.18081,1.1813500000000001,149271,0,0
68,2025-09-16 00:00:00+00:00,1.17611,1.18786,1.17575,1.1867,161532,0,0
67,2025-09-15 00:00:00+00:00,1.1727,1.17746,1.17158,1.17612,127523,0,0
66,2025-09-12 00:00:00+00:00,1.1731,1.17479,1.1701,1.17323,138450,0,0
65,2025-09-11 00:00:00+00:00,1.16948,1.1746,1.16595,1.17361,163820,0,0
64,2025-09-10 00:00:00+00:00,1.17055,1.17304,1.16824,1.16949,168746,0,0
63,2025-09-09 00:00:00+00:00,1.17619,1.17801,1.17037,1.17098,162269,0,0
62,2025-09-08 00:00:00+00:00,1.1712,1.17656,1.17036,1.1763,159633,0,0
61,2025-09-05 00:00:00+00:00,1.16461,1.17597,1.1645699999999999,1.17208,182198,0,0
60,2025-09-04 00:00:00+00:00,1.16588,1.16694,1.163,1.16509,158540,0,0
59,2025-09-03 00:00:00+00:00,1.1635,1.16824,1.16083,1.16612,135456,0,0
58,2025-09-02 00:00:00+00:00,1.17085,1.17184,1.16129,1.16417,212292,0,0
57,2025-09-01 00:00:00+00:00,1.16944,1.17364,1.16842,1.17113,130317,0,0
56,2025-08-29 00:00:00+00:00,1.16801,1.1709,1.16507,1.16869,155507,0,0
55,2025-08-28 00:00:00+00:00,1.16376,1.16973,1.1628,1.1682299999999999,155085,0,0
54,2025-08-27 00:00:00+00:00,1.16377,1.16478,1.15739,1.16376,149979,0,0
53,2025-08-26 00:00:00+00:00,1.16189,1.16654,1.16023,1.16406,192438,0,0
52,2025-08-25 00:00:00+00:00,1.1721,1.17258,1.16028,1.16194,149749,0,0
51,2025-08-22 00:00:00+00:00,1.15991,1.17427,1.15829,1.1721300000000001,153390,0,0
50,2025-08-21 00:00:00+00:00,1.16495,1.1663000000000001,1.16012,1.16063,142245,0,0
49,2025-08-20 00:00:00+00:00,1.16394,1.16738,1.16221,1.16505,126022,0,0
48,2025-08-19 00:00:00+00:00,1.16527,1.1693,1.16392,1.16469,127266,0,0
47,2025-08-18 00:00:00+00:00,1.17103,1.17159,1.16562,1.16612,122883,0,0
46,2025-08-15 00:00:00+00:00,1.16471,1.17155,1.16459,1.17032,120955,0,0
45,2025-08-14 00:00:00+00:00,1.17018,1.1715200000000001,1.1631,1.16483,156305,0,0
44,2025-08-13 00:00:00+00:00,1.1669,1.17303,1.1667,1.17045,133883,0,0
43,2025-08-12 00:00:00+00:00,1.16065,1.16973,1.15984,1.16732,179436,0,0
42,2025-08-11 00:00:00+00:00,1.16399,1.16755,1.159,1.16158,124568,0,0
41,2025-08-08 00:00:00+00:00,1.16584,1.16795,1.16288,1.1641,153567,0,0
40,2025-08-07 00:00:00+00:00,1.16538,1.16989,1.16111,1.16644,166322,0,0
39,2025-08-06 00:00:00+00:00,1.1571799999999999,1.16686,1.15642,1.16599,147775,0,0
38,2025-08-05 00:00:00+00:00,1.15683,1.1588,1.15276,1.15753,156229,0,0
37,2025-08-04 00:00:00+00:00,1.15897,1.15957,1.15495,1.15726,177088,0,0
36,2025-08-01 00:00:00+00:00,1.14156,1.1597,1.13916,1.15955,213053,0,0
35,2025-07-31 00:00:00+00:00,1.1403,1.14609,1.14014,1.1414,167347,0,0
34,2025-07-30 00:00:00+00:00,1.15472,1.15727,1.14008,1.14036,179048,0,0
33,2025-07-29 00:00:00+00:00,1.15875,1.15995,1.15189,1.15455,161436,0,0
32,2025-07-28 00:00:00+00:00,1.17532,1.17704,1.15853,1.1589,162820,0,0
31,2025-07-25 00:00:00+00:00,1.17414,1.17608,1.17032,1.17392,142429,0,0
30,2025-07-24 00:00:00+00:00,1.17671,1.17888,1.17304,1.17488,144788,0,0
29,2025-07-23 00:00:00+00:00,1.17529,1.17753,1.17109,1.17733,150315,0,0
28,2025-07-22 00:00:00+00:00,1.16906,1.17605,1.1679,1.17544,115415,0,0
27,2025-07-21 00:00:00+00:00,1.16236,1.17167,1.16144,1.16952,122247,0,0
26,2025-07-18 00:00:00+00:00,1.15912,1.16712,1.15871,1.16226,130242,0,0
25,2025-07-17 00:00:00+00:00,1.1633,1.16424,1.1555900000000001,1.15977,133644,0,0
24,2025-07-16 00:00:00+00:00,1.1599,1.17215,1.15624,1.16403,182273,0,0
23,2025-07-15 00:00:00+00:00,1.1660300000000001,1.16929,1.15929,1.16026,139030,0,0
22,2025-07-14 00:00:00+00:00,1.16619,1.1697899999999999,1.16544,1.16657,133681,0,0
21,2025-07-11 00:00:00+00:00,1.1700599999999999,1.17142,1.16649,1.16923,160848,0,0
20,2025-07-10 00:00:00+00:00,1.17157,1.17496,1.16626,1.17003,127371,0,0
19,2025-07-09 00:00:00+00:00,1.17166,1.17293,1.16897,1.17226,133603,0,0
18,2025-07-08 00:00:00+00:00,1.17075,1.17653,1.16824,1.17254,151123,0,0
17,2025-07-07 00:00:00+00:00,1.17773,1.17903,1.16865,1.17084,139308,0,0
16,2025-07-04 00:00:00+00:00,1.17586,1.17876,1.17519,1.17733,126438,0,0
15,2025-07-03 00:00:00+00:00,1.17958,1.18102,1.17172,1.17574,133768,0,0
14,2025-07-02 00:00:00+00:00,1.18038,1.18103,1.1747,1.17988,150206,0,0
13,2025-07-01 00:00:00+00:00,1.17801,1.18298,1.17614,1.18059,154981,0,0
12,2025-06-30 00:00:00+00:00,1.17282,1.17883,1.17078,1.1788,155306,0,0
11,2025-06-27 00:00:00+00:00,1.16957,1.1754,1.16805,1.17194,159553,0,0
10,2025-06-26 00:00:00+00:00,1.16562,1.17448,1.16533,1.17016,177330,0,0
9,2025-06-25 00:00:00+00:00,1.16017,1.16652,1.15899,1.16599,139014,0,0
8,2025-06-24 00:00:00+00:00,1.15778,1.16419,1.15736,1.16086,190183,0,0
7,2025-06-23 00:00:00+00:00,1.14553,1.15817,1.14536,1.15784,210521,0,0
6,2025-06-20 00:00:00+00:00,1.1494,1.15442,1.1486,1.15219,155972,0,0
5,2025-06-19 00:00:00+00:00,1.14786,1.15004,1.14462,1.14969,139346,0,0
4,2025-06-18 00:00:00+00:00,1.14759,1.15303,1.14609,1.14834,177289,0,0
3,2025-06-17 00:00:00+00:00,1.15564,1.15797,1.14748,1.14804,181677,0,0
2,2025-06-16 00:00:00+00:00,1.15255,1.16147,1.15238,1.15604,174697,0,0
1,2025-06-13 00:00:00+00:00,1.1580300000000001,1.16145,1.1489,1.15476,211861,0,0
0,2025-06-12 00:00:00+00:00,1.14863,1.16314,1.14831,1.15849,189175,0,0"""
}

# Define timeframes
timeframes = ['M15', 'H1', 'H4', 'D1']

print("[pattern-scanner] Starting comprehensive EURUSD pattern scan...")
print(f"[pattern-scanner] Current price: {current_price}")
print(f"[pattern-scanner] Analyzing timeframes: {', '.join(timeframes)}")

# Perform the complete scan
scan_results = scan_symbol_for_patterns(
    symbol='EURUSD',
    candles_data=candles_data,
    current_price=current_price,
    timeframes=timeframes
)

print(f"\n[pattern-scanner] Pattern detection complete")
print(f"[pattern-scanner] Overall bias: {scan_results['overall_bias']}")
print(f"[pattern-scanner] Total patterns found: {scan_results['pattern_counts']['total']}")
print(f"[pattern-scanner]   - Bullish: {scan_results['pattern_counts']['bullish']}")
print(f"[pattern-scanner]   - Bearish: {scan_results['pattern_counts']['bearish']}")
print(f"[pattern-scanner]   - Neutral: {scan_results['pattern_counts']['neutral']}")

# Calculate confluence
technical_scores_by_tf = {}
for tf in timeframes:
    if tf in scan_results['technical_snapshots'] and scan_results['technical_snapshots'][tf]:
        scores = scan_results['technical_snapshots'][tf]['scores']
        technical_scores_by_tf[tf] = scores

base_scores = technical_scores_by_tf.get('H1', {'long_probability': 50.0, 'short_probability': 50.0})

confluence_results = enhance_probability_with_patterns(
    base_scores=base_scores,
    patterns_by_timeframe=scan_results['patterns_by_timeframe'],
    levels_by_timeframe=scan_results['support_resistance'],
    current_price=current_price,
    technical_scores_by_timeframe=technical_scores_by_tf
)

print(f"\n[pattern-scanner] Confluence analysis complete")
print(f"[pattern-scanner] Signal: {confluence_results['signal']}")
print(f"[pattern-scanner] Primary probability: {confluence_results['primary_probability']}%")
print(f"[pattern-scanner] Long probability: {confluence_results['long_probability']}%")
print(f"[pattern-scanner] Short probability: {confluence_results['short_probability']}%")

# Generate HTML report
output_path = generate_html_report(
    symbol='EURUSD',
    scan_results=scan_results,
    confluence_results=confluence_results,
    output_dir='reports'
)

print(f"\n[pattern-scanner] Report generated successfully!")
print(f"[pattern-scanner] File: {output_path}")
print(f"\nâœ“ Scan complete - {output_path}")
