#!/usr/bin/env python3
import sys
from pathlib import Path
sys.path.insert(0, str(Path(__file__).parent))
from run_analysis import run_technical_analysis

# Datos de EURUSD obtenidos de MetaTrader
price_data = {"bid": 1.15747, "ask": 1.15747, "last": 0.0, "volume": 0, "time": "2025-10-30T16:44:22Z"}

# Datos de velas (últimas 50 por temporalidad para análisis rápido)
m15_csv = """,time,open,high,low,close,tick_volume,spread,real_volume
49,2025-10-30 16:30:00+00:00,1.15695,1.15754,1.15671,1.15747,2953,0,0
48,2025-10-30 16:15:00+00:00,1.15568,1.1571500000000001,1.15536,1.15695,3135,0,0
47,2025-10-30 16:00:00+00:00,1.15552,1.15574,1.1547,1.15568,3969,0,0
46,2025-10-30 15:45:00+00:00,1.15693,1.15696,1.15534,1.15552,3563,0,0
45,2025-10-30 15:30:00+00:00,1.15795,1.15828,1.15671,1.15692,2878,0,0
44,2025-10-30 15:15:00+00:00,1.15953,1.1596,1.15764,1.15796,2261,0,0
43,2025-10-30 15:00:00+00:00,1.15979,1.15993,1.15942,1.15954,2156,0,0
42,2025-10-30 14:45:00+00:00,1.16023,1.16032,1.15962,1.15979,2097,0,0
41,2025-10-30 14:30:00+00:00,1.16071,1.16111,1.1602000000000001,1.16024,2033,0,0
40,2025-10-30 14:15:00+00:00,1.16094,1.16106,1.16054,1.16072,2061,0,0
39,2025-10-30 14:00:00+00:00,1.16069,1.16114,1.16042,1.16094,2046,0,0
38,2025-10-30 13:45:00+00:00,1.16112,1.16126,1.1606,1.16068,1498,0,0
37,2025-10-30 13:30:00+00:00,1.16132,1.16172,1.16102,1.16113,1758,0,0
36,2025-10-30 13:15:00+00:00,1.16181,1.16191,1.16125,1.16131,1981,0,0
35,2025-10-30 13:00:00+00:00,1.16165,1.162,1.1615199999999999,1.16181,1947,0,0
34,2025-10-30 12:45:00+00:00,1.16197,1.16208,1.16153,1.16165,2385,0,0
33,2025-10-30 12:30:00+00:00,1.16254,1.16286,1.16193,1.16198,2274,0,0
32,2025-10-30 12:15:00+00:00,1.16191,1.16256,1.16187,1.16256,2093,0,0
31,2025-10-30 12:00:00+00:00,1.16173,1.16206,1.16144,1.16191,2460,0,0
30,2025-10-30 11:45:00+00:00,1.16148,1.16197,1.16136,1.16173,1867,0,0
29,2025-10-30 11:30:00+00:00,1.16138,1.16148,1.16099,1.16148,2210,0,0
28,2025-10-30 11:15:00+00:00,1.16103,1.1615199999999999,1.1607,1.16139,2581,0,0
27,2025-10-30 11:00:00+00:00,1.16183,1.16205,1.16068,1.16103,2889,0,0
26,2025-10-30 10:45:00+00:00,1.16121,1.16185,1.16097,1.16183,1682,0,0
25,2025-10-30 10:30:00+00:00,1.16163,1.16207,1.16117,1.1612,2160,0,0
24,2025-10-30 10:15:00+00:00,1.16163,1.16199,1.16136,1.16162,2402,0,0
23,2025-10-30 10:00:00+00:00,1.16195,1.1623,1.1615,1.16164,2477,0,0
22,2025-10-30 09:45:00+00:00,1.16209,1.16251,1.16187,1.16194,1800,0,0
21,2025-10-30 09:30:00+00:00,1.16253,1.16293,1.16181,1.16211,2370,0,0
20,2025-10-30 09:15:00+00:00,1.16293,1.16297,1.16248,1.16253,1376,0,0
19,2025-10-30 09:00:00+00:00,1.16242,1.1629800000000001,1.16233,1.16293,1159,0,0
18,2025-10-30 08:45:00+00:00,1.1630099999999999,1.16313,1.16235,1.16241,1361,0,0
17,2025-10-30 08:30:00+00:00,1.16254,1.16303,1.16247,1.1630099999999999,1022,0,0
16,2025-10-30 08:15:00+00:00,1.16307,1.16308,1.16247,1.16256,1065,0,0
15,2025-10-30 08:00:00+00:00,1.16321,1.16341,1.16282,1.16307,1480,0,0
14,2025-10-30 07:45:00+00:00,1.16295,1.16336,1.16284,1.16322,2020,0,0
13,2025-10-30 07:30:00+00:00,1.16331,1.16336,1.16267,1.16297,3403,0,0
12,2025-10-30 07:15:00+00:00,1.162,1.16374,1.16191,1.16332,2456,0,0
11,2025-10-30 07:00:00+00:00,1.16155,1.16207,1.16136,1.162,1549,0,0
10,2025-10-30 06:45:00+00:00,1.1610800000000001,1.16162,1.16103,1.16154,1255,0,0
9,2025-10-30 06:30:00+00:00,1.16122,1.16123,1.16069,1.16109,1547,0,0
8,2025-10-30 06:15:00+00:00,1.16196,1.16197,1.16088,1.16122,2357,0,0
7,2025-10-30 06:00:00+00:00,1.16173,1.16199,1.16162,1.16197,1227,0,0
6,2025-10-30 05:45:00+00:00,1.16164,1.16177,1.16149,1.16172,978,0,0
5,2025-10-30 05:30:00+00:00,1.16154,1.16172,1.16146,1.16164,993,0,0
4,2025-10-30 05:15:00+00:00,1.16195,1.16198,1.16146,1.16153,1098,0,0
3,2025-10-30 05:00:00+00:00,1.16139,1.16197,1.16122,1.16195,1241,0,0
2,2025-10-30 04:45:00+00:00,1.1614200000000001,1.16153,1.1613,1.1614,1120,0,0
1,2025-10-30 04:30:00+00:00,1.16092,1.16147,1.16088,1.16141,1291,0,0
0,2025-10-30 04:15:00+00:00,1.16134,1.16137,1.16086,1.16093,1283,0,0"""

h1_csv = """,time,open,high,low,close,tick_volume,spread,real_volume
49,2025-10-30 16:00:00+00:00,1.15552,1.15754,1.1547,1.15747,10062,0,0
48,2025-10-30 15:00:00+00:00,1.15979,1.15993,1.15534,1.15552,10858,0,0
47,2025-10-30 14:00:00+00:00,1.16069,1.16114,1.15962,1.15979,8237,0,0
46,2025-10-30 13:00:00+00:00,1.16165,1.162,1.1606,1.16068,7184,0,0
45,2025-10-30 12:00:00+00:00,1.16173,1.16286,1.16144,1.16165,9212,0,0
44,2025-10-30 11:00:00+00:00,1.16183,1.16205,1.16068,1.16173,9547,0,0
43,2025-10-30 10:00:00+00:00,1.16195,1.1623,1.16097,1.16183,8721,0,0
42,2025-10-30 09:00:00+00:00,1.16242,1.1629800000000001,1.16181,1.16194,6705,0,0
41,2025-10-30 08:00:00+00:00,1.16321,1.16341,1.16235,1.16241,4928,0,0
40,2025-10-30 07:00:00+00:00,1.16155,1.16374,1.16136,1.16322,9428,0,0
39,2025-10-30 06:00:00+00:00,1.16173,1.16199,1.16069,1.16154,6386,0,0
38,2025-10-30 05:00:00+00:00,1.16139,1.16198,1.16122,1.16172,4310,0,0
37,2025-10-30 04:00:00+00:00,1.16119,1.16153,1.16086,1.1614,5396,0,0
36,2025-10-30 03:00:00+00:00,1.16029,1.16156,1.15968,1.16119,5845,0,0
35,2025-10-30 02:00:00+00:00,1.16038,1.16053,1.16014,1.1602999999999999,1814,0,0
34,2025-10-30 01:00:00+00:00,1.16018,1.1605699999999999,1.16012,1.16038,1844,0,0
33,2025-10-30 00:00:00+00:00,1.16001,1.1604,1.15993,1.16018,729,12,0
32,2025-10-29 23:00:00+00:00,1.15992,1.16072,1.15907,1.16007,4644,0,0
31,2025-10-29 22:00:00+00:00,1.15945,1.16,1.1577600000000001,1.15992,16321,0,0
30,2025-10-29 21:00:00+00:00,1.16468,1.16511,1.15841,1.15945,21467,0,0
29,2025-10-29 20:00:00+00:00,1.16573,1.16591,1.16456,1.16465,6366,0,0
28,2025-10-29 19:00:00+00:00,1.16637,1.16659,1.16553,1.16573,8104,0,0
27,2025-10-29 18:00:00+00:00,1.16504,1.16646,1.1645,1.16636,9666,0,0
26,2025-10-29 17:00:00+00:00,1.16368,1.16514,1.16316,1.16504,9040,0,0
25,2025-10-29 16:00:00+00:00,1.16342,1.16458,1.16336,1.16368,11026,0,0
24,2025-10-29 15:00:00+00:00,1.1639599999999999,1.1645,1.16276,1.16341,9666,0,0
23,2025-10-29 14:00:00+00:00,1.16472,1.16486,1.1633,1.16397,6899,0,0
22,2025-10-29 13:00:00+00:00,1.16412,1.16488,1.1637,1.16472,6318,0,0
21,2025-10-29 12:00:00+00:00,1.16231,1.1647,1.16187,1.16411,8310,0,0
20,2025-10-29 11:00:00+00:00,1.16324,1.16342,1.16228,1.16231,8183,0,0
19,2025-10-29 10:00:00+00:00,1.1629800000000001,1.1638,1.16283,1.1632500000000001,8115,0,0
18,2025-10-29 09:00:00+00:00,1.16316,1.16327,1.1625,1.16297,5293,0,0
17,2025-10-29 08:00:00+00:00,1.16343,1.16357,1.16272,1.16315,5290,0,0
16,2025-10-29 07:00:00+00:00,1.16374,1.16377,1.16315,1.16341,3525,0,0
15,2025-10-29 06:00:00+00:00,1.16464,1.16468,1.16368,1.16372,3056,0,0
14,2025-10-29 05:00:00+00:00,1.16475,1.1648100000000001,1.16417,1.16462,3302,0,0
13,2025-10-29 04:00:00+00:00,1.16545,1.16561,1.16462,1.16474,5611,0,0
12,2025-10-29 03:00:00+00:00,1.16572,1.16609,1.16531,1.16545,7860,0,0
11,2025-10-29 02:00:00+00:00,1.16505,1.16574,1.16486,1.16572,1888,0,0
10,2025-10-29 01:00:00+00:00,1.16511,1.16544,1.16498,1.16505,2205,0,0
9,2025-10-29 00:00:00+00:00,1.16501,1.16529,1.16501,1.16512,1082,12,0
8,2025-10-28 23:00:00+00:00,1.16524,1.16573,1.1651,1.16523,2744,0,0
7,2025-10-28 22:00:00+00:00,1.16621,1.16653,1.16519,1.16524,4290,0,0
6,2025-10-28 21:00:00+00:00,1.16633,1.16638,1.16561,1.1662,4427,0,0
5,2025-10-28 20:00:00+00:00,1.16681,1.16689,1.16593,1.16632,7210,0,0
4,2025-10-28 19:00:00+00:00,1.16589,1.1668,1.1653,1.1668,8926,0,0
3,2025-10-28 18:00:00+00:00,1.16605,1.1667399999999999,1.1655,1.16589,9395,0,0
2,2025-10-28 17:00:00+00:00,1.1639599999999999,1.16634,1.1637,1.16605,11170,0,0
1,2025-10-28 16:00:00+00:00,1.16402,1.16406,1.16253,1.16395,10154,0,0
0,2025-10-28 15:00:00+00:00,1.16593,1.16601,1.16351,1.16402,10147,0,0"""

h4_csv = """,time,open,high,low,close,tick_volume,spread,real_volume
29,2025-10-30 16:00:00+00:00,1.15552,1.15754,1.1547,1.15749,10067,0,0
28,2025-10-30 12:00:00+00:00,1.16173,1.16286,1.15534,1.15552,35491,0,0
27,2025-10-30 08:00:00+00:00,1.16321,1.16341,1.16068,1.16173,29901,0,0
26,2025-10-30 04:00:00+00:00,1.16119,1.16374,1.16069,1.16322,25520,0,0
25,2025-10-30 00:00:00+00:00,1.16001,1.16156,1.15968,1.16119,10232,0,0
24,2025-10-29 20:00:00+00:00,1.16573,1.16591,1.1577600000000001,1.16007,48798,0,0
23,2025-10-29 16:00:00+00:00,1.16342,1.16659,1.16316,1.16573,37836,0,0
22,2025-10-29 12:00:00+00:00,1.16231,1.16488,1.16187,1.16341,31193,0,0
21,2025-10-29 08:00:00+00:00,1.16343,1.1638,1.16228,1.16231,26881,0,0
20,2025-10-29 04:00:00+00:00,1.16545,1.16561,1.16315,1.16341,15494,0,0
19,2025-10-29 00:00:00+00:00,1.16501,1.16609,1.16486,1.16545,13035,0,0
18,2025-10-28 20:00:00+00:00,1.16681,1.16689,1.1651,1.16523,18671,0,0
17,2025-10-28 16:00:00+00:00,1.16402,1.1668,1.16253,1.1668,39645,0,0
16,2025-10-28 12:00:00+00:00,1.16522,1.16651,1.16351,1.16402,30769,0,0
15,2025-10-28 08:00:00+00:00,1.16659,1.1668,1.1648399999999999,1.16525,26643,0,0
14,2025-10-28 04:00:00+00:00,1.16556,1.16678,1.16539,1.16659,15544,0,0
13,2025-10-28 00:00:00+00:00,1.16443,1.16588,1.16439,1.16556,10305,0,0
12,2025-10-27 20:00:00+00:00,1.16388,1.16521,1.1635,1.16441,15825,0,0
11,2025-10-27 16:00:00+00:00,1.16415,1.16429,1.16317,1.16389,32614,0,0
10,2025-10-27 12:00:00+00:00,1.16285,1.16515,1.16261,1.16415,30093,0,0
9,2025-10-27 08:00:00+00:00,1.16246,1.16333,1.16174,1.16284,24791,0,0
8,2025-10-27 04:00:00+00:00,1.16347,1.16478,1.16208,1.16245,15265,0,0
7,2025-10-27 00:00:00+00:00,1.1632,1.16377,1.16221,1.16349,13458,0,0
6,2025-10-24 20:00:00+00:00,1.16257,1.1636,1.16209,1.16272,16289,0,0
5,2025-10-24 16:00:00+00:00,1.16341,1.16434,1.16178,1.16257,41148,0,0
4,2025-10-24 12:00:00+00:00,1.161,1.16485,1.16053,1.16341,34397,0,0
3,2025-10-24 08:00:00+00:00,1.16076,1.16281,1.1601,1.16104,29017,0,0
2,2025-10-24 04:00:00+00:00,1.1617899999999999,1.1619,1.1605699999999999,1.16077,11396,0,0
1,2025-10-24 00:00:00+00:00,1.16163,1.16218,1.16139,1.1617899999999999,7842,0,0
0,2025-10-23 20:00:00+00:00,1.16069,1.1620300000000001,1.16043,1.1617899999999999,14403,0,0"""

d1_csv = """,time,open,high,low,close,tick_volume,spread,real_volume
14,2025-10-30 00:00:00+00:00,1.16001,1.16374,1.1547,1.15749,111211,0,0
13,2025-10-29 00:00:00+00:00,1.16501,1.16659,1.1577600000000001,1.16007,173237,0,0
12,2025-10-28 00:00:00+00:00,1.16443,1.16689,1.16253,1.16523,141577,0,0
11,2025-10-27 00:00:00+00:00,1.1632,1.16521,1.16174,1.16441,132046,0,0
10,2025-10-24 00:00:00+00:00,1.16163,1.16485,1.1601,1.16272,140089,0,0
9,2025-10-23 00:00:00+00:00,1.16058,1.1620300000000001,1.15852,1.1617899999999999,123169,0,0
8,2025-10-22 00:00:00+00:00,1.15977,1.16224,1.1577,1.16094,145951,0,0
7,2025-10-21 00:00:00+00:00,1.16404,1.16553,1.15978,1.15995,173311,0,0
6,2025-10-20 00:00:00+00:00,1.1661299999999999,1.16757,1.16383,1.16412,146656,0,0
5,2025-10-17 00:00:00+00:00,1.16826,1.17283,1.16504,1.16531,190600,0,0
4,2025-10-16 00:00:00+00:00,1.16433,1.16943,1.1641,1.16873,185963,0,0
3,2025-10-15 00:00:00+00:00,1.16058,1.16476,1.16016,1.16471,174168,0,0
2,2025-10-14 00:00:00+00:00,1.15635,1.1615,1.1542,1.16077,201336,0,0
1,2025-10-13 00:00:00+00:00,1.16109,1.16299,1.15575,1.15705,172282,0,0
0,2025-10-10 00:00:00+00:00,1.15642,1.16306,1.1553,1.16245,185786,0,0"""

# Preparar datos para análisis
mcp_data = {
    "price": price_data,
    "candles_m15": m15_csv,
    "candles_h1": h1_csv,
    "candles_h4": h4_csv,
    "candles_d1": d1_csv
}

# Ejecutar análisis
result = run_technical_analysis("EURUSD", mcp_data)

# Imprimir resultado
print(result["formatted_output"])
